---
description: 介绍 Shell 脚本的常用语法
---

# Shell 脚本

下面介绍一下 Shell 脚本的常用写法

在 shell 脚本的开头，都需要有如下的开头，这行代码的主要作用是：指定默认情况之下运行脚本的解释器，

> https://zhuanlan.zhihu.com/p/666028747

```sh
#!/bin/bash
```

## 一、注释

:::code-group

```sh [单行注释]
# 单行注释
```

```sh [多行注释]
:<<EOF
注释内容
EOF
```

:::

## 二、变量

:::=tabs
::定义变量

```sh
# 定义变量
name=''
```

::使用变量

```sh
# echo 是 shell 之中用来进行输出的
# $ 符号是 shell 之中，是用来获取变量的，这里也可以不写 {}, 写的目的主要是为了区分变量的边界
echo ${变量名}
```

::只读变量

```sh
# 方式一
readonly 变量名
# 方式二
declare -r 变量名
```

::删除变量

```sh
# 当一个变量被删除之后，后面如果读取，就是空字符串
unset 变量名
```

::外部变量

除了在 shell 文件之中定义变量之外，还可以由外部传入

> 注意，这里是从 1 开始的，${0} 用来表示 shell 的路径

```sh
# 定义 shell 脚本，内容如下
#!/bin/bash
echo ${1}
```

在执行时，就可以通过：`./a.sh 12`  将 12 赋值给了 `${1}`

这里有些默认的命令

:::

## 三、字符串

字符串可以用单引号，也可以用双引号，也可以不用引号。单引号与双引号的区别：

- 单引号中的内容会原样输出，不会执行、不会取变量；
- 双引号中的内容可以执行、可以取变量；

```sh
name='coding'
name1='${name}'
# 输出：${name}
echo ${name1};

name2="${name}"
# 输出：coding
echo ${name2};

# 获取字符串的长度
length=${#name};
echo ${length};

# 截取字符串
echo ${name:0:5}
```

## 四、数组

:::=tabs
::定义数组

元素之间使用空格进行隔开

```sh
list=(1 'coding 666' 2);
```

::获取元素

```sh
# 获取某个元素的值
${list[0]}

# 获取整个数组的值
${list[@]}
${list[*]}
```

::数组长度

```sh
${#list[@]}
${#list[*]}
```

:::

## 五、expr

expr 命令用来求表达式的值，格式为：

```sh
expr 表达式

# 获取表达式的结果
`expr 表达式`

$(expr 表达式)
```

### 5.1 字符串表达式

```sh
str='Hello world' 

# 获取字符串的长度，将其保存到 strLength 变量里面             
strLength=$(expr length "$str")
echo ${strLength}

# 获取指定字符串在目标字符串之中的下标                       
strIndex=$(expr index "${str}" l)
echo ${strIndex}

# 从指定位置开始，截取指定长度的字符串                       
subStr=$(expr substr "$str" 2 3)
echo ${subStr}
```

### 5.2 整数运算符

expr 支持普通的算术操作，不过请注意，对于 `* / %` 都需要使用  `\`  进行转义

```sh
a=1
b=2
echo `expr $a + $b`

echo `expr $a \* $b`

echo `expr \( $a + $b \) / \( $b - $a \)`
```

### 5.3 逻辑运算符

`|`： 或运算，运算两边只要有一个非 0 即可，会按照顺序返回非0的参数值，即如果左边为0，右边不为0，则返回右边

`&`：与运算，运算两边都必须非0，如果两边都是非0的，返回结果实际上是第一个参数

`< <= > >= != `

```sh
a=1
b=0
echo `expr $a \| $b`
echo `expr $a \& $b
```

## 六、test

test 命令用来判断文件类型，以及对变量做比较，其中 0 表示真，非0 表示假。其中 test 命令用 `exit code` 返回结果

:::=tabs
::文件类型判断

| 参数 | 意义         |
| ---- | ------------ |
| -e   | 文件是否存在 |
| -f   | 是否是文件   |
| -d   | 是否是目录   |

::文件权限判断

| 参数 | 意义           |
| ---- | -------------- |
| -r   | 文件是否可读   |
| -w   | 文件是否可写   |
| -x   | 文件是否可执行 |
| -s   | 是否为非空文件 |

::整数间的比较

命令格式：

```sh
test $a -eq $b  # a是否等于b
```

| 参数 | 意义     |
| ---- | -------- |
| -eq  | 相等     |
| -ne  | 不相等   |
| -gt  | 大于     |
| -ge  | 大于登录 |
| -lt  | 小于     |
| -le  | 小于等于 |

::字符串对比

| 参数              | 意义                                                   |
| ----------------- | ------------------------------------------------------ |
| test -z STRING    | 判断STRING是否为空，如果为空，则返回true               |
| test -n STRING    | 判断STRING是否非空，如果非空，则返回true（-n可以省略） |
| test str1 == str2 | 判断str1是否等于str2                                   |
| test str1 != str2 | 判断str1是否不等于str2                                 |

::多重条件判断

| 参数 | 意义                     |
| ---- | ------------------------ |
| -a   | 两个条件是否同时成立     |
| -o   | 两条件是否至少有一个成立 |
| ！   | 取反                     |

:::

## 七、判断语句

:::=tabs
::if

```sh
if condition
then
	语句
fi

```

::示例

```sh
if condition
then
	语句
else
	语句
```

:::

## 八、循环语句

## 九、函数

## 十、exit命令

